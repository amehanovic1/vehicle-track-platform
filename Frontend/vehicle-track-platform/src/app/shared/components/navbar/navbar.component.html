<nav class="navbar">
  <div class="navbar-container">
    <a class="navbar-brand" routerLink="/dashboard" style="text-decoration: none;">
      <span class="navbar-title">AutoTrack <span class="navbar-title-pro">PRO</span></span>
    </a>

    <div class="navbar-menu">
        <a class="navbar-item" routerLink="/home" routerLinkActive="is-active">
          Dashboard
        </a>
      <div class="navbar-start" *ngIf="user">

        <a *ngIf="canAccess('vehicles')" class="navbar-item" routerLink="/vehicles" routerLinkActive="is-active">
          Vehicles
        </a>
        <a *ngIf="canAccess('companies')" class="navbar-item" routerLink="/companies" routerLinkActive="is-active">
          Companies
        </a>
        <a *ngIf="canAccess('serviceRequests')" class="navbar-item" routerLink="/service-requests" routerLinkActive="is-active">
          Service Requests
        </a>

        <a
          *ngIf="canAccess('serviceRequestsCompany') && companyId"
          class="navbar-item"
          [routerLink]="['/companies', companyId, 'service-requests']"
          routerLinkActive="is-active"
        >
          Service Requests
        </a>


        <a *ngIf="canAccess('trafficFines')" class="navbar-item" routerLink="/traffic-fines" routerLinkActive="is-active">
          Traffic Fines
        </a>
        <a *ngIf="canAccess('fuelPrices')" class="navbar-item" routerLink="/fuel-prices" routerLinkActive="is-active">
          Fuel Prices
        </a>
        <div *ngIf="canAccess('usersDropdown')" class="navbar-dropdown">
          <a class="navbar-item">
            Users <i class="fas fa-chevron-down"></i>
          </a>
          <div class="dropdown-content">
            <a class="dropdown-item" routerLink="/drivers">Drivers</a>
            <a class="dropdown-item" routerLink="/employees">Employees</a>
          </div>
        </div>
      </div>

      
    </div>

    <div class="navbar-end">
        <ng-container *ngIf="userInfo$ | async as userInfo; else showLogin">
          <!--<button class="navbar-item report-btn" (click)="downloadReport()">
            <i class="fas fa-file-pdf"></i> Download Report
          </button>-->
          <div class="user-profile-dropdown" (click)="toggleProfileMenu()" (blur)="onProfileBlur($event)" tabindex="0">
            <div class="user-profile">
              <i class="fas fa-user-circle"></i>
              <div class="user-info">
                <span class="user-name">{{ userInfo.firstName || 'Guest' }}</span>
                <span class="user-role">{{ userInfo.email || 'Not logged in' }}</span>
              </div>
              <i class="fas fa-chevron-down profile-arrow"></i>
            </div>
            <div class="profile-dropdown-menu" [class.show]="profileMenuOpen">
              <a class="profile-menu-item" routerLink="/settings">
                <i class="fas fa-cog"></i> Settings
              </a>
              <div class="menu-divider"></div>
              <a class="profile-menu-item logout-item" (click)="logout()">
                <i class="fas fa-sign-out-alt"></i> Logout
              </a>
            </div>
          </div>
        </ng-container>

        <ng-template #showLogin>
          <a class="navbar-item login-btn" routerLink="/login" style="text-decoration:none;">
            <i class="fas fa-sign-in-alt"></i> Login
          </a>
        </ng-template>
      </div>
  </div>
</nav>
